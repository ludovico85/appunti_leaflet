<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/qgis2web.css">
		<link rel="stylesheet" href="css/leaflet-sidebar.css"><!-- css relativo alla sidebar-->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"><!-- css relativo alle icone - settare in locale-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" /> <!-- bootsratp style -->
		<style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title></title>
    </head>
    <body>
	<div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs !!!Importante settare ZoomControl False-->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fa fa-bars"></i></a></li>
                <li><a href="#profile" role="tab"><i class="fa fa-user"></i></a></li>
                <li class="disabled"><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>
                <li><a href="https://github.com/Turbo87/sidebar-v2" role="tab" target="_blank"><i class="fa fa-github"></i></a></li>
            </ul>

            <ul role="tablist">
                <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
            </ul>
        </div>

        <!-- Tab panes -->
        <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">
                    sidebar-v2
                    <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
                </h1>

                <p>A responsive sidebar for mapping libraries like <a href="http://leafletjs.com/">Leaflet</a> or <a href="http://openlayers.org/">OpenLayers</a>.</p>

                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>

                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>

                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>

                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
            </div>

            <div class="sidebar-pane" id="profile">
                <h1 class="sidebar-header">Profile<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
				<p id="geotext"></p>
            </div>

            <div class="sidebar-pane" id="messages">
                <h1 class="sidebar-header">Messages<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
            </div>

            <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Settings<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
            </div>
        </div>
    </div>
	
<div id="map">
</div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="data/punto_0.js"></script>
		<script src="js/leaflet-sidebar.js"></script><!-- js script per sidebar -->
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> <!-- call to jquery necessario per far funzionare la sidebar-->
        <script>
        var map = L.map('map', {
            zoomControl:false, maxZoom:28, minZoom:1
        }).fitBounds([[41.42707519295937,14.028197164374895],[41.852031206522376,15.268442586939527]]);
        var hash = new L.Hash(map);
        map.attributionControl.addAttribution('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a>');
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
		
		// variabile per aprire la sidebar; object_id Ã¨ id delle feaures nel geoJson, 'geotext' e la parte della sidebar dove far apparire il contenuto.
		//sidebar.open('') e la tab che si deve aprire
		var results = [];
          //open sidebar and more content when clicking button in popup
          var thisResult;
          function openSidebar(ID) {
              if ($('#sidebar-text').text().length > 0) {
                  $("#sidebar-text").removeText();
              }
              for (var i = 0, len = results.length; i < len; i++) {
                  if (results[i].object_id === parseInt(ID)) {
                      thisResult = (results[i]);
                  }
              }
              sidebar.open('profile');
              var divToAddContent = document.getElementById('geotext');
              divToAddContent.innerHTML = 'scrivere un titolo, se necessario aggiungere il tag h4'+'<br></br>'+'prova'+thisResult.tipo;
              }
		
        function pop_punto_0(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['object_id'] !== null ? Autolinker.link(String(feature.properties['object_id'])) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2"><strong>tipo</strong><br />' + (feature.properties['tipo'] !== null ? Autolinker.link(String(feature.properties['tipo'])) : '') + '</td>\
                    </tr>\
					<tr>\
					<td> <img src=' + feature.properties.Foto + ' width=100%/> </td>\
					</tr>\
					<tr>\<td><br></td></tr>\
					<tr>\
					<td><button type = "button" class= "btn btn-primary sidebar-open-button" ' + feature.properties.object_id + '>CLICK ON ME</button></td>\
					</tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }
		//nella tabella va aggiunta la foto; width regola la foto ma dipende anche dalla width del popup//
		//<button type = "button" class= "btn btn-primary sidebar-open-button" </button> aggiunge un pulsante con lo stile bootstrap//
		
        function style_punto_0_0(feature) {
            switch(String(feature.properties['tipo'])) {
                case 'aereoporto':
                    return {
                pane: 'pane_punto_0',
                radius: 10.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(93,171,213,1.0)',
            }
                    break;
                case 'edificio':
                    return {
                pane: 'pane_punto_0',
                radius: 10.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(74,220,48,1.0)',
            }
                    break;
                case 'porto':
                    return {
                pane: 'pane_punto_0',
                radius: 10.0,
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(187,54,210,1.0)',
            }
                    break;
            }
        }
        map.createPane('pane_punto_0');
        map.getPane('pane_punto_0').style.zIndex = 400;
        map.getPane('pane_punto_0').style['mix-blend-mode'] = 'normal';
        var layer_punto_0 = new L.geoJson(json_punto_0, {
            attribution: '<a href=""></a>',
            pane: 'pane_punto_0',
            onEachFeature: pop_punto_0,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_punto_0_0(feature));
            },
        });
        bounds_group.addLayer(layer_punto_0);
        map.addLayer(layer_punto_0);
        var baseMaps = {};
		
		var zoomControl = L.control.zoom({position: 'bottomright'}).addTo(map); //spostare lo zoom control
		var sidebar = L.control.sidebar('sidebar').addTo(map); //aggiunge la sidebar funzionante

		//document.getElementById("bringToBack").addEventListener
		// funzione necessaria all'apertura della sidebar
		$("div").on("click", '.sidebar-open-button', function () {
		var ID = $(this).attr("data");
		openSidebar(ID);
		});
		
        L.control.layers(baseMaps,{'punto<br /><table><tr><td style="text-align: center;"><img src="legend/punto_0_aereoporto0.png" /></td><td>aereoporto</td></tr><tr><td style="text-align: center;"><img src="legend/punto_0_edificio1.png" /></td><td>edificio</td></tr><tr><td style="text-align: center;"><img src="legend/punto_0_porto2.png" /></td><td>porto</td></tr></table>': layer_punto_0,},{collapsed:false}).addTo(map);
        setBounds();
        </script>
    </body>
</html>
